var pdfSvgAttr={g:["stroke","fill","stroke-width"],line:["x1","y1","x2","y2","stroke","stroke-width"],rect:["x","y","width","height","stroke","fill","stroke-width"],ellipse:["cx","cy","rx","ry","stroke","fill","stroke-width"],circle:["cx","cy","r","stroke","fill","stroke-width"],text:["x","y","font-size","font-family","text-anchor","font-weight","font-style","fill"]},removeAttributes=function(t,e){var r=[];$.each(t.attributes,function(t,a){void 0!==a&&-1==e.indexOf(a.name.toLowerCase())&&r.push(a.name)}),$.each(r,function(e,r){t.removeAttribute(r.name)})},svgElementToPdf=function(t,e,r){var a=void 0!==r.removeInvalid&&r.removeInvalid,s=void 0===r.scale?1:r.scale,i=null;return $(t).children().each(function(t,o){var n=$(o),l=!1;if(n.is("g,line,rect,ellipse,circle,text")){var c=n.attr("fill");if(void 0!==c){var f=new RGBColor(c);f.ok?(l=!0,i="F"):i=null}}if(n.is("g,line,rect,ellipse,circle")){l&&e.setFillColor(f.r,f.g,f.b),void 0!==n.attr("stroke-width")&&e.setLineWidth(s*parseInt(n.attr("stroke-width")));var v=n.attr("stroke");if(void 0!==v){var d=new RGBColor(v);d.ok?(!0,e.setDrawColor(d.r,d.g,d.b),i="F"==i?"FD":null):i=null}}switch(n.get(0).tagName.toLowerCase()){case"svg":case"a":case"g":svgElementToPdf(o,e,r),removeAttributes(o,pdfSvgAttr.g);break;case"line":e.line(s*parseInt(n.attr("x1")),s*parseInt(n.attr("y1")),s*parseInt(n.attr("x2")),s*parseInt(n.attr("y2"))),removeAttributes(o,pdfSvgAttr.line);break;case"rect":e.rect(s*parseInt(n.attr("x")),s*parseInt(n.attr("y")),s*parseInt(n.attr("width")),s*parseInt(n.attr("height")),i),removeAttributes(o,pdfSvgAttr.rect);break;case"ellipse":e.ellipse(s*parseInt(n.attr("cx")),s*parseInt(n.attr("cy")),s*parseInt(n.attr("rx")),s*parseInt(n.attr("ry")),i),removeAttributes(o,pdfSvgAttr.ellipse);break;case"circle":e.circle(s*parseInt(n.attr("cx")),s*parseInt(n.attr("cy")),s*parseInt(n.attr("r")),i),removeAttributes(o,pdfSvgAttr.circle);break;case"text":if(o.hasAttribute("font-family"))switch(n.attr("font-family").toLowerCase()){case"serif":e.setFont("times");break;case"monospace":e.setFont("courier");break;default:n.attr("font-family","sans-serif"),e.setFont("helvetica")}l&&e.setTextColor(f.r,f.g,f.b);var h="";o.hasAttribute("font-weight")&&("bold"==n.attr("font-weight")?h="bold":o.removeAttribute("font-weight")),o.hasAttribute("font-style")&&("italic"==n.attr("font-style")?h+="italic":o.removeAttribute("font-style")),e.setFontType(h);var p=16;o.hasAttribute("font-size")&&(p=parseInt(n.attr("font-size")));var u,b,g=o.getBBox(),x=0;if(o.hasAttribute("text-anchor")){switch(n.attr("text-anchor")){case"end":x=g.width;break;case"middle":x=g.width/2;break;case"start":break;case"default":n.attr("text-anchor","start")}u=parseInt(n.attr("x"))-x,b=parseInt(n.attr("y"))}e.setFontSize(p).text(s*u,s*b,n.text()),removeAttributes(o,pdfSvgAttr.text);break;default:a&&(console.log("can't translate to pdf:",o),n.remove())}}),e};!function(t){"use strict";jsPDF.API.addSVG=function(t,e,r,a){return a=void 0===a?{}:a,a.x_offset=e,a.y_offset=r,svgElementToPdf(t,this,a),this}}();